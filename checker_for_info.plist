import plistlib

with open("Info.plist", "rb") as f:
    plist = plistlib.load(f)

insecure_settings = {
    "UIFileSharingEnabled": "File sharing enabled!",
    "NSAllowsArbitraryLoads": "Insecure HTTP traffic allowed!",
    "LSApplicationQueriesSchemes": "App fingerprinting risk!",
    "NSUserTrackingUsageDescription": "User tracking enabled!",
}

for key, message in insecure_settings.items():
    if key in plist and plist[key]:
        print(f"[!] {message} -> {plist[key]}")
